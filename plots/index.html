
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A short description of my project">
      
      
        <link rel="canonical" href="https://sahirbhatnagar.github.io/eclust/plots/">
      
      
        <meta name="author" content="Sahir Rai Bhatnagar">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.2">
    
    
      
        <title>Heatmaps - eclust</title>
      
    
    
      <script src="../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-1b8b9fdf68.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02ce7adcc2.palette.css">
      
      
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="eclust" class=" md-logo  md-header-nav__button">
          
            <img src="../images/dte1.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Heatmaps
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
              


  


  <a href="https://github.com/sahirbhatnagar/eclust" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      eclust
    </div>
  </a>

            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-logo  md-nav__button">
      
        <img src="../images/dte1.png">
      
    </i>
    eclust
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/sahirbhatnagar/eclust" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      eclust
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href=".." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../installation/" title="Installation" class="md-nav__link">
        Installation
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../data/" title="Data" class="md-nav__link">
        Data
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../overview/" title="Package Functions" class="md-nav__link">
        Package Functions
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../rda/" title="Real Data Analysis" class="md-nav__link">
        Real Data Analysis
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../simulation/" title="Simulations" class="md-nav__link">
        Simulations
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Heatmaps
      </label>
    
    <a href="./" title="Heatmaps" class="md-nav__link md-nav__link--active">
      Heatmaps
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plot-method-for-object-of-class-similarity" title="Plot Method for Object of class similarity" class="md-nav__link">
    Plot Method for Object of class similarity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot-method-for-object-of-class-eclust" title="Plot Method for Object of class eclust" class="md-nav__link">
    Plot Method for Object of class eclust
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plot-method-for-object-of-class-similarity" title="Plot Method for Object of class similarity" class="md-nav__link">
    Plot Method for Object of class similarity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plot-method-for-object-of-class-eclust" title="Plot Method for Object of class eclust" class="md-nav__link">
    Plot Method for Object of class eclust
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                <h1 id="plots">Plots<a class="headerlink" href="#plots" title="Permanent link">&para;</a></h1>
<h2 id="plot-method-for-object-of-class-similarity">Plot Method for Object of class <code>similarity</code><a class="headerlink" href="#plot-method-for-object-of-class-similarity" title="Permanent link">&para;</a></h2>
<p>There is a plot method for similarity matrices included in this package, though it is very specific to the simulated data only since the resulting plot annotates the true cluster membership of the genes. The plot uses the <code>pheatmap</code> package for the heatmaps along with the <code>viridis</code> package for the color scheme so these packages need to be installed prior to using this function.</p>
<p>The plot method is for objects of class <code>similarity</code>. The following objects, which are outputs of the <code>s_generate_data</code> function, are objects of class <code>similarity</code>:</p>
<table style="width:21%;">
<colgroup>
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">object.name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">tom_train_all</td>
</tr>
<tr class="even">
<td align="center">tom_train_diff</td>
</tr>
<tr class="odd">
<td align="center">tom_train_e1</td>
</tr>
<tr class="even">
<td align="center">tom_train_e0</td>
</tr>
<tr class="odd">
<td align="center">corr_train_all</td>
</tr>
<tr class="even">
<td align="center">corr_train_diff</td>
</tr>
<tr class="odd">
<td align="center">corr_train_e1</td>
</tr>
<tr class="even">
<td align="center">corr_train_e0</td>
</tr>
<tr class="odd">
<td align="center">fisherScore</td>
</tr>
<tr class="even">
<td align="center">corScor</td>
</tr>
</tbody>
</table>

<p>To plot the heatmap of the similarity matrix, you need to provide it with the clustering tree, the cluster membership and the genes active in the response. In this example we plot the TOM matrix for the exposed subjects given by the <code>tom_train_e1</code> object. The resulting heatmap has annotations for the cluster membership and if the gene is active in the response:</p>
<div class="codehilite"><pre><span></span><span class="c1"># check that the object is of class similarity</span>
<span class="kp">class</span><span class="p">(</span>result<span class="o">$</span>tom_train_e1<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## [1] &quot;matrix&quot;     &quot;similarity&quot;
</pre></div>


<div class="codehilite"><pre><span></span><span class="c1"># get clustering tree</span>
hc <span class="o">&lt;-</span> hclust<span class="p">(</span>as.dist<span class="p">(</span><span class="m">1</span> <span class="o">-</span> result<span class="o">$</span>tom_train_e1<span class="p">),</span> method <span class="o">=</span> <span class="s">&quot;average&quot;</span><span class="p">)</span>

plot<span class="p">(</span>result<span class="o">$</span>tom_train_e1<span class="p">,</span> 
     truemodule <span class="o">=</span> truemodule1<span class="p">,</span> 
     cluster_rows <span class="o">=</span> hc<span class="p">,</span> 
     cluster_cols <span class="o">=</span> hc<span class="p">,</span>
     active <span class="o">=</span> <span class="kp">as.numeric</span><span class="p">(</span>betaMainEffect<span class="o">!=</span><span class="m">0</span><span class="p">))</span>
</pre></div>


<p><img alt="" src="../plots_files/figure-markdown_github/unnamed-chunk-3-1.png" /></p>
<hr />
<h2 id="plot-method-for-object-of-class-eclust">Plot Method for Object of class <code>eclust</code><a class="headerlink" href="#plot-method-for-object-of-class-eclust" title="Permanent link">&para;</a></h2>
<p>There is also a function that plots heatmaps of cluster summaries such as the 1st principal component or average by exposure status. This is a plot method for object of class eclust returned by the <code>r_cluster_data</code> function. Two heatmaps, side-by-side are returned, where the first heatmap corresponds to the unexposed subjects and the second heatmap corresponds to the exposed subjects.</p>
<div class="codehilite"><pre><span></span><span class="c1"># load the data</span>
data<span class="p">(</span><span class="s">&quot;tcgaov&quot;</span><span class="p">)</span>

<span class="c1"># use log survival as the response</span>
Y <span class="o">&lt;-</span> <span class="kp">log</span><span class="p">(</span>tcgaov<span class="p">[[</span><span class="s">&quot;OS&quot;</span><span class="p">]])</span>

<span class="c1"># specify the environment variable</span>
E <span class="o">&lt;-</span> tcgaov<span class="p">[[</span><span class="s">&quot;E&quot;</span><span class="p">]]</span>

<span class="c1"># specify the matrix of genes only</span>
genes <span class="o">&lt;-</span> <span class="kp">as.matrix</span><span class="p">(</span>tcgaov<span class="p">[,</span><span class="o">-</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;OS&quot;</span><span class="p">,</span><span class="s">&quot;rn&quot;</span><span class="p">,</span><span class="s">&quot;subtype&quot;</span><span class="p">,</span><span class="s">&quot;E&quot;</span><span class="p">,</span><span class="s">&quot;status&quot;</span><span class="p">),</span>with <span class="o">=</span> <span class="kc">FALSE</span><span class="p">])</span>

<span class="c1"># for this example the training set will be all subjects.</span>
<span class="c1"># change `p` argument to create a train and test set.</span>
trainIndex <span class="o">&lt;-</span> <span class="kp">drop</span><span class="p">(</span>caret<span class="o">::</span>createDataPartition<span class="p">(</span>Y<span class="p">,</span> p <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="kt">list</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> times <span class="o">=</span> <span class="m">1</span><span class="p">))</span>
testIndex <span class="o">&lt;-</span> trainIndex

cluster_res <span class="o">&lt;-</span> r_cluster_data<span class="p">(</span>data <span class="o">=</span> genes<span class="p">,</span>
                              response <span class="o">=</span> Y<span class="p">,</span>
                              exposure <span class="o">=</span> E<span class="p">,</span>
                              train_index <span class="o">=</span> trainIndex<span class="p">,</span>
                              test_index <span class="o">=</span> testIndex<span class="p">,</span>
                              cluster_distance <span class="o">=</span> <span class="s">&quot;corr&quot;</span><span class="p">,</span>
                              eclust_distance <span class="o">=</span> <span class="s">&quot;diffcorr&quot;</span><span class="p">,</span>
                              measure_distance <span class="o">=</span> <span class="s">&quot;euclidean&quot;</span><span class="p">,</span>
                              clustMethod <span class="o">=</span> <span class="s">&quot;hclust&quot;</span><span class="p">,</span>
                              cutMethod <span class="o">=</span> <span class="s">&quot;dynamic&quot;</span><span class="p">,</span>
                              method <span class="o">=</span> <span class="s">&quot;average&quot;</span><span class="p">,</span>
                              nPC <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                              minimum_cluster_size <span class="o">=</span> <span class="m">30</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>##  ..cutHeight not given, setting it to 10.9  ===&gt;  99% of the (truncated) height range in dendro.
##  ..done.

## Calculating number of environment clusters based on diffcorr

##  ..cutHeight not given, setting it to 0.923  ===&gt;  99% of the (truncated) height range in dendro.
##  ..done.

## There are 7 clusters derived from the corr similarity matrix

## There are 4 clusters derived from the diffcorr environment similarity matrix

## There are a total of 11 clusters derived from the corr
##                   similarity matrix and the diffcorr environment similarity matrix
</pre></div>


<p>We check the class of the object returned from the clustering results on the <code>tcgaov</code> data:</p>
<div class="codehilite"><pre><span></span><span class="kp">class</span><span class="p">(</span>cluster_res<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## [1] &quot;eclust&quot;
</pre></div>


<p>We simply pass this object to the generic <code>plot</code> function:</p>
<div class="codehilite"><pre><span></span>plot<span class="p">(</span>cluster_res<span class="p">,</span> show_column_names <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>


<p><img alt="" src="../plots_files/figure-markdown_github/unnamed-chunk-6-1.png" /></p>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../simulation/" title="Simulations" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Simulations
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Sahir Rai Bhatnagar
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/sahirbhatnagar" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/syfi_24" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-16f434a21a.js"></script>
      <script>var config={url:{base:".."}},app=new Application(config);app.initialize()</script>
      
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>